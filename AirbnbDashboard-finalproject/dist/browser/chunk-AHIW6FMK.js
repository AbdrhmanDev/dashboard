import{a as k,b as R}from"./chunk-34EDBLWL.js";import{a as z}from"./chunk-4EAS6AWH.js";import{a as A}from"./chunk-B3EB67NJ.js";import{a as B}from"./chunk-RDQSKPKJ.js";import{a as I}from"./chunk-3T5IVP2F.js";import"./chunk-FN5D4CQR.js";import{Bb as c,Fb as S,Lb as i,Mb as e,Qc as P,Rc as _,Sc as M,Ub as y,Xc as O,Zc as E,_c as w,cc as n,dc as s,eb as a,ec as b,fc as g,jb as m,mc as u,nc as v,pc as h,qb as C,ub as x}from"./chunk-3C7H3B7F.js";var f=(l,t)=>({positive:l,negative:t});function D(l,t){if(l&1&&(i(0,"div",3)(1,"div",4)(2,"span",5),n(3,"people"),e()(),i(4,"div",6)(5,"h3"),n(6,"Total Users"),e(),i(7,"div",7),n(8),e(),i(9,"div",8)(10,"span",5),n(11),e(),n(12),e()()()),l&2){let o=y();a(8),s(o.totalUsers),a(),c("ngClass",u(5,f,o.usersChange>=0,o.usersChange<0)),a(2),s(o.usersChange>=0?"trending_up":"trending_down"),a(),g(" ",o.Math.abs(o.usersChange),"% ",o.usersChange>=0?"increase":"decrease"," ")}}function F(l,t){if(l&1&&(i(0,"tr")(1,"td"),n(2),e(),i(3,"td"),n(4),v(5,"currency"),e(),i(6,"td"),n(7),v(8,"date"),e(),i(9,"td")(10,"span"),n(11),e()()()),l&2){let o=t.$implicit;a(2),s(o.userId),a(2),s(h(5,6,o.amount,"$")),a(3),s(h(8,9,o.createdAt,"short")),a(3),S("status "+o.status),a(),s(o.status)}}function H(l,t){if(l&1&&(i(0,"tr")(1,"td"),n(2),e(),i(3,"td"),n(4),e(),i(5,"td"),n(6),v(7,"currency"),e(),i(8,"td"),n(9),e()()),l&2){let o=t.$implicit;a(2),s(o.status),a(2),s(o.count),a(2),s(h(7,4,o.totalAmount,"$")),a(3),b("",o.percentage,"%")}}var U=class l{constructor(t,o,r,p,d,T){this.paymentService=t;this.userService=o;this.bookingService=r;this.hotelService=p;this.userStateService=d;this.revenueService=T}isAdmin=!1;userSubscription;totalUsers=0;totalBookings=0;totalRevenue=0;totalHotels=0;usersChange=0;bookingsChange=0;revenueChange=0;hotelsChange=0;latestPayments=[];paymentSummary=[];Math=Math;isLoading=!0;error=null;getRevenue=0;ngOnInit(){this.userSubscription=this.userStateService.user$.subscribe(t=>{this.isAdmin=t?.role==="Admin"}),this.loadAnalyticsData()}loadAnalyticsData(){this.isLoading=!0,this.error=null,this.revenueService.getRevenue().subscribe({next:t=>{this.getRevenue=t.totalRevenue},error:t=>{console.error("Error loading revenue:",t)}}),this.paymentService.getPayments().subscribe({next:t=>{this.latestPayments=t.slice(0,5),this.calculatePaymentSummary(t)},error:t=>{this.error="Failed to load payment data",console.error("Payment data error:",t)}}),this.paymentService.getPaymentSummary().subscribe({next:t=>{this.totalRevenue=t.totalAmount,this.revenueChange=t.completedAmount},error:t=>{console.error("Payment summary error:",t)}}),this.userService.getUsers().subscribe({next:t=>{this.totalUsers=t.length,this.usersChange=0},error:t=>{console.error("User data error:",t)}}),this.bookingService.getBookings().subscribe({next:t=>{this.totalBookings=t.length,this.bookingsChange=0},error:t=>{console.error("Booking data error:",t)}}),this.hotelService.getHotels().subscribe({next:t=>{this.totalHotels=t.length,this.hotelsChange=0,this.isLoading=!1},error:t=>{console.error("Hotel data error:",t),this.isLoading=!1}})}calculatePaymentSummary(t){let o=new Map;t.forEach(p=>{let d=o.get(p.status)||{count:0,totalAmount:0};o.set(p.status,{count:d.count+1,totalAmount:d.totalAmount+p.amount})});let r=t.length;this.paymentSummary=Array.from(o.entries()).map(([p,d])=>({status:p,count:d.count,totalAmount:d.totalAmount,percentage:(d.count/r*100).toFixed(1)}))}refreshData(){this.loadAnalyticsData()}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}static \u0275fac=function(o){return new(o||l)(m(B),m(I),m(A),m(R),m(k),m(z))};static \u0275cmp=C({type:l,selectors:[["app-analytics"]],decls:78,vars:30,consts:[[1,"analytics-container"],[1,"stats-grid"],["class","stat-card",4,"ngIf"],[1,"stat-card"],[1,"stat-icon"],[1,"material-icons"],[1,"stat-details"],[1,"stat-value"],[1,"stat-change",3,"ngClass"],[1,"analytics-tables"],[1,"table-card"],[1,"table-responsive"],[4,"ngFor","ngForOf"]],template:function(o,r){o&1&&(i(0,"div",0)(1,"div",1),x(2,D,13,8,"div",2),i(3,"div",3)(4,"div",4)(5,"span",5),n(6,"hotel"),e()(),i(7,"div",6)(8,"h3"),n(9,"Total Bookings"),e(),i(10,"div",7),n(11),e(),i(12,"div",8)(13,"span",5),n(14),e(),n(15),e()()(),i(16,"div",3)(17,"div",4)(18,"span",5),n(19,"attach_money"),e()(),i(20,"div",6)(21,"h3"),n(22,"Total Revenue"),e(),i(23,"div",7),n(24),v(25,"currency"),e(),i(26,"div",8)(27,"span",5),n(28),e(),n(29),e()()(),i(30,"div",3)(31,"div",4)(32,"span",5),n(33,"apartment"),e()(),i(34,"div",6)(35,"h3"),n(36,"Total Hotels"),e(),i(37,"div",7),n(38),e(),i(39,"div",8)(40,"span",5),n(41),e(),n(42),e()()()(),i(43,"div",9)(44,"div",10)(45,"h3"),n(46,"Latest Payments"),e(),i(47,"div",11)(48,"table")(49,"thead")(50,"tr")(51,"th"),n(52,"User"),e(),i(53,"th"),n(54,"Amount"),e(),i(55,"th"),n(56,"Date"),e(),i(57,"th"),n(58,"Status"),e()()(),i(59,"tbody"),x(60,F,12,12,"tr",12),e()()()(),i(61,"div",10)(62,"h3"),n(63,"Payment Summary"),e(),i(64,"div",11)(65,"table")(66,"thead")(67,"tr")(68,"th"),n(69,"Status"),e(),i(70,"th"),n(71,"Count"),e(),i(72,"th"),n(73,"Amount"),e(),i(74,"th"),n(75,"Percentage"),e()()(),i(76,"tbody"),x(77,H,10,7,"tr",12),e()()()()()()),o&2&&(a(2),c("ngIf",r.isAdmin),a(9),s(r.totalBookings),a(),c("ngClass",u(21,f,r.bookingsChange>=0,r.bookingsChange<0)),a(2),s(r.bookingsChange>=0?"trending_up":"trending_down"),a(),g(" ",r.Math.abs(r.bookingsChange),"% ",r.bookingsChange>=0?"increase":"decrease"," "),a(9),s(h(25,18,r.getRevenue,"$")),a(2),c("ngClass",u(24,f,r.revenueChange>=0,r.revenueChange<0)),a(2),s(r.revenueChange>=0?"trending_up":"trending_down"),a(),g(" ",r.Math.abs(r.revenueChange),"% ",r.revenueChange>=0?"increase":"decrease"," "),a(9),s(r.totalHotels),a(),c("ngClass",u(27,f,r.hotelsChange>=0,r.hotelsChange<0)),a(2),s(r.hotelsChange>=0?"trending_up":"trending_down"),a(),g(" ",r.Math.abs(r.hotelsChange),"% ",r.hotelsChange>=0?"increase":"decrease"," "),a(18),c("ngForOf",r.latestPayments),a(17),c("ngForOf",r.paymentSummary))},dependencies:[w,P,_,M,E,O],styles:[".analytics-container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto}@media (max-width: 768px){.analytics-container[_ngcontent-%COMP%]{padding:10px}}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px}@media (max-width: 768px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:15px}}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;display:flex;align-items:center;gap:20px;box-shadow:0 2px 4px #0000001a;transition:transform .2s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}@media (max-width: 768px){.stat-card[_ngcontent-%COMP%]{padding:15px}}.stat-icon[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:#e3f2fd}@media (max-width: 768px){.stat-icon[_ngcontent-%COMP%]{width:40px;height:40px}}.stat-icon[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:24px;color:#1976d2}@media (max-width: 768px){.stat-icon[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px}}.stat-details[_ngcontent-%COMP%]{flex:1}.stat-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#666;font-weight:500}.stat-details[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#2c3e50;margin:5px 0}@media (max-width: 768px){.stat-details[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:20px}}.stat-details[_ngcontent-%COMP%]   .stat-change[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;font-size:14px}.stat-details[_ngcontent-%COMP%]   .stat-change.positive[_ngcontent-%COMP%]{color:#388e3c}.stat-details[_ngcontent-%COMP%]   .stat-change.negative[_ngcontent-%COMP%]{color:#d32f2f}.stat-details[_ngcontent-%COMP%]   .stat-change[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px}.analytics-tables[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(450px,1fr));gap:20px}@media (max-width: 768px){.analytics-tables[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:15px}}.table-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 4px #0000001a}@media (max-width: 768px){.table-card[_ngcontent-%COMP%]{padding:15px}}.table-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;color:#2c3e50;font-size:18px;font-weight:600}@media (max-width: 768px){.table-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;margin-bottom:15px}}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:600px}@media (max-width: 768px){table[_ngcontent-%COMP%]{min-width:500px}}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #eee}@media (max-width: 768px){th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:8px;font-size:14px}}th[_ngcontent-%COMP%]{font-weight:600;color:#666;background-color:#f8f9fa;position:sticky;top:0;z-index:1}.status[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:12px;text-transform:capitalize;display:inline-block;min-width:80px;text-align:center}.status.completed[_ngcontent-%COMP%]{background:#e8f5e9;color:#388e3c}.status.pending[_ngcontent-%COMP%]{background:#fff3e0;color:#f57c00}.status.failed[_ngcontent-%COMP%]{background:#ffebee;color:#d32f2f}.loading[_ngcontent-%COMP%]{opacity:.7;pointer-events:none}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#666}.empty-state[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:48px;color:#ccc;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0 0;font-size:14px}"]})};export{U as AnalyticsComponent};
